
RULES:

# Transform all identifier to random valid identifier.
# This Rule require syntax knowledge.
#
# %A::IDENTIFIER% used to matching any grammar element whose type
# is IDENTIFIER.
#
# %RDIdent(A)% is a command use
RandomIdentifier:
    {| %T %I = %E |} => {| %T $IDENT = %E |}
    # Conditional Parts of Rewrite Rule
    where T \in Type /\ I \in Identifier

RDI_Assign: {strat: RDI_Multiply}
   {| %I = %E |} => {| %RDID(%I) = %E |}
   where %I = RandomIdentifier::%I /\
         Scope(%I) = Scope(RandomIdentifier::%I)

RDI_Multiply:
   {| %I * %E |} => {| $IDENT * %E |}
   where %I = RandomIdentifier::%I /\
         Scope(%I) = Scope(RandomIdentifier::%I)

STRATEGIES:
   rename-identifier =
     RandomIdentifier
     <+ RDI_Assign
     <+ RDI_Multiply
